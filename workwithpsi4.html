<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="cache-control" content="max-age=86400"/>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenRDM: Working with Psi4 plugins</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js", "braket.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="OpenRDM.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenRDM
   </div>
   <div id="projectbrief">An open-source library for reduced-density matrix-based analysis and computation</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('workwithpsi4.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Working with Psi4 plugins </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#pluginnote">A brief note on Psi4 plugins</a></li>
<li class="level1"><a href="#psi4openrdm">How does OpenRDM connect with Psi4 plugins?</a><ul><li class="level2"><a href="#usingpython">Using python</a></li>
<li class="level2"><a href="#usingcmake">Using CMake</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="pluginnote"></a>
A brief note on Psi4 plugins</h1>
<p>Psi4 plugins are (shared) <a href="https://cmake.org/cmake/help/v3.16/command/add_library.html?highlight=module">module libraries</a> that are <b>not</b> intended to be linked to another target entity. However, modules are created mainly because they can dynamically be imported at runtime by the consuming programs. In our sample <a href="https://github.com/SinaMostafanejad/v2rdm_casscf/blob/OpenRDM-interface/tests/v2rdm_casscf_pdft/input.dat">input file</a> , we show how to import both <em>v2rdm_casscf</em> and <em>mcpdft</em> modules. This input file assumes that you have chosen the second way below (recommended) for connecting OpenRDM with your plugin. At lines 51 and 53 of this input file, we call two functions that are provided by these modules:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;en,wfn=energy(<span class="stringliteral">&#39;v2rdm-casscf&#39;</span>,return_wfn=<span class="keyword">True</span>)</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;energy(<span class="stringliteral">&#39;mcpdft&#39;</span>,ref_wfn=wfn)</div></div><!-- fragment --><p>The <em>energy('v2rdm-casscf')</em> call generates a <em>wfn</em> object that is needed by the second <em>energy('mcpdft')</em> call. Be sure to add the corresponding <em>return_wfn</em> and <em>ref_wfn</em> arguments to these function calls, respectively as shown.</p>
<h1><a class="anchor" id="psi4openrdm"></a>
How does OpenRDM connect with Psi4 plugins?</h1>
<p>There are at least two ways that you can adopt to let <b>OpenRDM</b> talk to your Psi4 plugin:</p>
<ul>
<li>Using python commands in your input files</li>
<li>Using CMake commands in the <em>CMakeList.txt</em> file within plugin's source directory</li>
</ul>
<p>Before adopting one of these routes, make sure that both Psi4 and <b>OpenRDM</b> are installed on your system in the aforementioned order as the latter becomes dependent on the former in the present case.</p>
<p>When installing <b>OpenRDM</b>, turn on the CMake option <em>WITH_PSI4=ON</em> (see <a href="https://github.com/SinaMostafanejad/OpenRDM/blob/master/configure">configure</a> file in <b>OpenRDM</b>'s main source directory for more details). Activating this option requires that the CMake <em>psi4_DIR</em> variable in the configure script to be set to the directory that contains the <em>psi4Config.cmake</em> file so that CMake's <em>find_packge()</em> function within <b>OpenRDM</b> is able to find the <em>psi4::core</em> IMPORTED target and links it to <b>OpenRDM</b>.</p>
<h2><a class="anchor" id="usingpython"></a>
Using python</h2>
<p>Assuming that you have installed <b>OpenRDM</b> in <em>/home/OpenRDM</em> directory, include the following command in the begining of your Psi4 input file and then import the MCPDFT module:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;sys.path.insert(0, <span class="stringliteral">&#39;/home/OpenRDM/build/stage&#39;</span>)</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="keyword">import</span> mcpdft</div></div><!-- fragment --><p>In the present example, the <em>mcpdft.so</em> module lives in the <em>/home/<b>OpenRDM</b>/build/stage/lib</em> directory.</p>
<p>Check the <a href="https://github.com/SinaMostafanejad/v2rdm_casscf/blob/OpenRDM-interface/tests/v2rdm_casscf_pdft/input.dat">input file</a> in our <a href="https://github.com/SinaMostafanejad/v2rdm_casscf">v2RDM-CASSCF plugin fork</a> for more details.</p>
<h2><a class="anchor" id="usingcmake"></a>
Using CMake</h2>
<p>If the infrastructure of your software is managed by the CMake build system generator, we recommend that your first take a glance at <a class="el" href="howtouse.html">How to Use</a> section. After finding out about what you need to add to the CMakeLists.txt file residing in the main source directory of your project, CMake's internal <em>find_package()</em> takes care of finding and incorporating all necessary information about the <b>OpenRDM</b> by interrogating the <em>openrdm::openrdm</em> <a href="https://cmake.org/cmake/help/v3.17/manual/cmake-buildsystem.7.html?highlight=imported#imported-targets">IMPORTED target</a>. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.14-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
