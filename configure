#/bin/cmake
#============================ Pre-configure ========================
#rm -rf cmake_install.cmake \
#       CMakeFiles/ \
#       CMakeCache.txt \
#       mcpdft \
#       build/
#
#mkdir build && cd build
cd build
#============================ Configure ============================
#cmake -G "Ninja" -DCMAKE_BUILD_TYPE=Debug \
cmake -G "Unix Makefiles" -DCMAKE_BUILD_TYPE=Release \
      -DCODE_COVERAGE=ON \
      -DBUILD_TESTING=ON \
      -DWITH_ARMADILLO=OFF \
      -DWITH_LIBXC=OFF \
      -DWITH_HDF5=ON \
      -DWITH_OPENMP=ON \
      ..
      #-DLibxc_DIR=<Address of Libxc installation> for
      #find_package(Libxc) to be able to find it
#============================ Build ================================
#cmake --build . --target clean
cmake --build . --config Release -- -j $(nproc)
#============================ Install ==============================
make install #for Unix Makefiles
#ninja install #for Ninja
#============================ Test =================================
ctest -V -j $(nproc)
#ctest -j $(nproc) -M Experimental -T Start --track "Test Series" \
#      -T Configure \
#      -T Build \
#      -T Test \
#      -T Coverage
#======================= Generate Diagram ==========================
#cmake --graphvis=diagram.dot ..
#dot -T png diagram.dot -o diagram.png
