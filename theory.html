<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="cache-control" content="max-age=86400"/>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenRDM: Theory</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js", "braket.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="OpenRDM.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenRDM
   </div>
   <div id="projectbrief">An open-source library for reduced-density matrix-based analysis and computation</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('theory.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Theory </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#background">Background</a></li>
<li class="level1"><a href="#mcpdft">Multiconfiguration Pair-Density Functional Theory</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="background"></a>
Background</h1>
<p>Here, we use the conventional notation of multireference (MR) methods when labeling the molecular orbitals (MOs), \(\lbrace \psi\rbrace\): the indices \(i\), \(j\), \(k\), and \(l\) denote inactive (doubly occupied) orbitals; \(t\), \(u\), \(v\), and \(w\) represent active orbitals; and \(p\), \(q\), \(r\), and \(s\) indicate general orbitals. <a href="http://mathworld.wolfram.com/EinsteinSummation.html">Einstein's summation rule</a> is implied in all expressions.</p>
<p>We begin by defining the non-relativistic Born-Oppenheimer (BO) electronic Hamiltonian</p>
<p class="formulaDsp">
\begin{equation}\tag{1}\label{EQ:HAMILTONIAN} \hat{H} = h^p_q \hat{E}^p_q + \frac{1}{2} \nu^{pq}_{rs} \hat{e}^{pq}_{rs}, \end{equation}
</p>
<p>in terms of one- and two-particle excitation operators which are defined as</p>
<p class="formulaDsp">
\begin{gather} \hat{E}^{p}_{q} = \hat{a}^\dagger_{p_\sigma} \hat{a}_{q_\sigma} \tag{2a}\label{EQ:Epq} \\ \hat{e}^{p r}_{q s} = \hat{E}^p_q \hat{E}^r_s - \delta^q_r \hat{E}^p_s = \hat{a}^\dagger_{p_\sigma} \hat{a}^\dagger_{r_\tau} \hat{a}_{s_\tau} \hat{a}_{q_\sigma} \tag{2b}\label{EQ:epqrs} \end{gather}
</p>
<p>In Eqs. \(\eqref{EQ:Epq}\) and \(\eqref{EQ:epqrs}\), the \(\hat{a}^\dagger\) and \(\hat{a}\) represent second-quantized creation and annihilation operators, respectively, and the Greek labels run over \(\alpha\) and \(\beta\) spins (the sum over which is implied). The symbol \(h^p_q = \left&lt;\psi_p|\hat{h}|\psi_q\right&gt;\) represents the sum of the electron kinetic energy and electron-nucleus potential energy integrals, and \(\nu^{pq}_{rs} = \left&lt;\psi_p \psi_q|\psi_r\psi_s\right&gt;\) is an element of the two-electron repulsion integral tensor. Because the electronic Hamiltonian includes up to only pair-wise interactions, the ground-state energy of a many-electron system can be expressed as an exact linear functional of the the one-electron reduced-density matrix (1-RDM) and two-electron reduced-density matrix (2-RDM)</p>
<p class="formulaDsp">
\begin{equation}\tag{3}\label{EQ:Eel} E = {}^1D^p_q h^p_q + \frac{1}{2} {}^2D^{pq}_{rs} \nu^{pq}_{rs}. \end{equation}
</p>
<p>Here, the 1-RDM and the 2-RDM are represented in their spin-free forms, with elements defined as</p>
<p class="formulaDsp">
\begin{equation}\tag{4a} {}^1D^p_q = {}^1D^{p_\sigma}_{q_\sigma} = \left&lt;\Psi|\hat{a}^\dagger_{p_\sigma} \hat{a}_{q_\sigma}|\Psi\right&gt; \label{EQ:1RDM} \end{equation}
</p>
<p>and</p>
<p class="formulaDsp">
\begin{equation}\tag{4b} {}^2D^{pq}_{rs} = {}^2D^{p_\sigma q_\tau}_{r_\sigma s_\tau} = \left&lt;\Psi|\hat{a}^\dagger_{p_\sigma} \hat{a}^\dagger_{q_\tau} \hat{a}_{s_\tau} \hat{a}_{r_\sigma}|\Psi\right&gt; \label{EQ:2RDM}, \end{equation}
</p>
<p>respectively. Again, the summation over the spin labels in Eqs. \(\eqref{EQ:1RDM}\) and \(\eqref{EQ:2RDM}\) is implied.</p>
<h1><a class="anchor" id="mcpdft"></a>
Multiconfiguration Pair-Density Functional Theory</h1>
<p>The multiconfiguration pair-density functional theory (MC-DPFT) energy expression can be written as</p>
<p class="formulaDsp">
\begin{equation}\tag{5}\label{EQ:EMC-PDFT} E_{\text{MC-PDFT}} = 2h^i_i + h^t_u {}^1D^t_u + E_\text{H} + E_\text{xc}\left[\rho,\Pi,|\nabla\rho|,|\nabla\Pi|\right], \end{equation}
</p>
<p>where the Hartree energy, \(E_\text{H}\), is</p>
<p class="formulaDsp">
\begin{equation}\tag{6}\label{EQ:EHARTREE} E_\text{H} = 2 \nu^{ij}_{ij} + 2\nu^{ti}_{ui} {}^1D^t_u + \frac{1}{2} \nu^{tv}_{uw} {}^1D^{t}_{u} {}^1D^{v}_{w} \end{equation}
</p>
<p>The total electronic density and its gradient are defined by the 1-RDM as</p>
<p class="formulaDsp">
\begin{equation}\label{EQ:RHO}\tag{7} \rho(\mathbf{r}) = {}^1D^p_q\ \psi^*_p(\mathbf{r}) \psi_q(\mathbf{r}), \end{equation}
</p>
<p>and</p>
<p class="formulaDsp">
\begin{equation}\label{EQ:DRHO}\tag{8} \nabla\rho(\mathbf{r}) = {}^1D^p_q \left[ \nabla\psi^*_p(\mathbf{r}) \psi_q(\mathbf{r}) + \psi^*_p(\mathbf{r}) \nabla\psi_q(\mathbf{r}) \right], \end{equation}
</p>
<p>respectively. The on-top pair density (OTPD) and its gradient can similarly be defined in terms of the 2-RDM as</p>
<p class="formulaDsp">
\begin{equation} \label{EQ:PI}\tag{9} \Pi(\mathbf{r}) = {}^2D^{pq}_{rs}\ \psi^*_p(\mathbf{r}) \psi^*_q(\mathbf{r}) \psi_r(\mathbf{r}) \psi_s(\mathbf{r}), \end{equation}
</p>
<p>and</p>
<p class="formulaDsp">
\begin{eqnarray} \label{EQ:DPI}\tag{10} \nabla\Pi(\mathbf{r}) = {}^2D^{pq}_{rs} &amp;[&amp; \nabla\psi^*_p(\mathbf{r}) \psi^*_q(\mathbf{r}) \psi_r(\mathbf{r}) \psi_s(\mathbf{r}) \nonumber \\\ &amp;+&amp; \psi^*_p(\mathbf{r}) \nabla\psi^*_q(\mathbf{r}) \psi_r(\mathbf{r}) \psi_s(\mathbf{r}) \nonumber \\\ &amp;+&amp; \psi^*_p(\mathbf{r}) \psi^*_q(\mathbf{r}) \nabla\psi_r(\mathbf{r}) \psi_s(\mathbf{r}) \nonumber \\\ &amp;+&amp; \psi^*_p(\mathbf{r}) \psi^*_q(\mathbf{r}) \psi_r(\mathbf{r}) \nabla\psi_s(\mathbf{r}) ~], \end{eqnarray}
</p>
<p>respectively. Here, the 1- and 2-RDMs are obtained from an MR computation.</p>
<p>At this stage, we must identify a suitable OTPD functional for use in MC-PDFT. The simplest class of functionals can be derived from existing approximate exchange-correlation (XC) functionals employed within Kohn-Sham DFT by first recognizing that, for a density derived from a single Slater determinant, the spin magnetization can be expressed exactly in terms of the OTPD and the total density. [<a href="https://journals.aps.org/pra/abstract/10.1103/PhysRevA.44.1549">1</a>, <a href="https://doi.org/10.1007/BF01114982">2</a>] More specifically, the spin polarization factor, \(\zeta(\mathbf{r}) = m(\mathbf{r})/\rho(\mathbf{r})\), can be expressed as</p>
<p class="formulaDsp">
\begin{equation} \label{EQ:ZETR}\tag{11} \zeta(\mathbf{r}) = \sqrt{1-R(\mathbf{r})}, \end{equation}
</p>
<p>where</p>
<p class="formulaDsp">
\begin{equation} \label{EQ:OTR}\tag{12} R(\mathbf{r}) = \frac{4~ \Pi(\mathbf{r})}{\rho^2(\mathbf{r})}. \end{equation}
</p>
<p>The basic assumption underlying the "translated" (t) OTPD functionals proposed in Ref. [<a href="https://doi.org/10.1021/ct500483t">3</a>] is that the spin polarization factor can be similarly defined for a density and OTPD obtained from a MR method, as</p>
<p class="formulaDsp">
\begin{eqnarray} \label{EQ:TR}\tag{13} \zeta_{\text{tr}}(\mathbf{r}) =&amp; \begin{cases} \sqrt{1-R(\mathbf{r})} ,&amp; \quad R(\mathbf{r}) \leq 1 \\\ 0 ,&amp; \quad R(\mathbf{r}) &gt; 1 \end{cases} \end{eqnarray}
</p>
<p>where the second case accounts for the fact that the argument of the square root can become negative for \(\rho(\mathbf{r})\) and \(\Pi(\mathbf{r})\) that are not derived from a single-configuration wave function. The translated OTPD functional is then defined as</p>
<p class="formulaDsp">
\begin{equation} \label{EQ:TRE}\tag{14} E_{\text{OTPD}}\left[\rho(\mathbf{r}), \Pi(\mathbf{r}),| \nabla\rho(\mathbf{r})| \right] \equiv E_{\text{xc}}[\tilde{\rho}_\alpha(\mathbf{r}), \tilde{\rho}_\beta(\mathbf{r}), |\nabla\tilde{\rho}_\alpha(\mathbf{r})|, |\nabla\tilde{\rho}_\beta(\mathbf{r})|], \end{equation}
</p>
<p>where the tilde refers to translated densities and their gradients, given by [<a href="https://doi.org/10.1021/ct500483t">3</a>,<a href="https://doi.org/10.1021/acs.accounts.6b00471">4</a>]</p>
<p class="formulaDsp">
\begin{equation} \label{EQ:TRHO}\tag{15} \tilde{\rho}_\sigma(\mathbf{r}) = \frac{\rho(\mathbf{r})}{2} \left(1 + c_\sigma \zeta_{\text{tr}}(\mathbf{r})\right), \end{equation}
</p>
<p>and</p>
<p class="formulaDsp">
\begin{equation}\tag{16} \nabla\tilde{\rho}_\sigma(\mathbf{r}) = \frac{\nabla\rho(\mathbf{r})}{2} \left(1 + c_\sigma \zeta_{\text{tr}}(\mathbf{r})\right), \end{equation}
</p>
<p>respectively. Here, \(c_\sigma\) = 1~(-1) when \(\sigma = \alpha\) ( \(\beta\)).</p>
<p>It is important to note that, in deriving the translated OTPD functional expression in Eq. \(\eqref{EQ:TRE}\), no dependence on \(\nabla\Pi(\mathbf{r})\) is assumed. A scheme in which the OTPD functional depends explicitly upon \(\nabla\Pi(\mathbf{r})\) has also been proposed.[<a href="https://doi.org/10.1021/acs.jctc.7b00967">5</a>] The corresponding "fully-translated" (ft) functionals are defined as</p>
<p class="formulaDsp">
\begin{equation} \label{EQ:FTRE}\tag{17} E_{\text{OTPD}}\left[\rho(\mathbf{r}), \Pi(\mathbf{r}), |\nabla\rho(\mathbf{r})|,|\nabla\Pi(\mathbf{r}) \right|] \equiv E_{\text{xc}}[\tilde{\rho}_\alpha(\mathbf{r}), \tilde{\rho}_\beta(\mathbf{r}), |\nabla\tilde{\rho}_\alpha(\mathbf{r})|, |\nabla\tilde{\rho}_\beta(\mathbf{r})|] \end{equation}
</p>
 </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.14-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
